<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>هواشناسی ایران</title>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
<style>
  /* Base & General Styles */
  body {
    font-family: 'Vazirmatn', sans-serif;
    direction: rtl;
    background: linear-gradient(to bottom, #e0f7fa, #fff);
    margin: 0;
    padding: 0;
    color: #333;
    line-height: 1.6;
  }

  /* Header */
  header {
    text-align: center;
    padding: 30px 20px;
    background-color: #00838f;
    color: white;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  header h1 {
    margin: 0;
    font-size: 2.5em;
  }

  /* Main Container */
  .container {
    max-width: 900px;
    margin: 20px auto;
    padding: 20px;
  }

  /* Selector Section */
  .selectors-section {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
    margin-bottom: 30px;
    padding: 20px;
    background-color: #f5f5f5;
    border-radius: 12px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  }

  .selector-group {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  select {
    padding: 10px 15px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 8px;
    min-width: 150px;
    transition: all 0.3s ease;
  }

  select:focus {
    border-color: #00796b;
    box-shadow: 0 0 5px rgba(0, 121, 107, 0.5);
    outline: none;
  }

  /* Weather Info Section */
  #weather-info {
    text-align: center;
    margin-bottom: 30px;
  }

  .weather-data-card {
    background-color: #fff;
    padding: 20px;
    border-radius: 12px;
    display: inline-block;
    min-width: 300px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
  }

  .weather-data-card:hover {
    transform: translateY(-5px);
  }
  
  #current-data img {
    width: 80px;
    height: 80px;
    margin-bottom: 10px;
  }

  #forecast {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 15px;
    margin-top: 20px;
  }

  .forecast-card {
    background-color: #e0f2f1;
    padding: 15px;
    border-radius: 10px;
    width: 150px;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .forecast-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }
  
  .forecast-card img {
    width: 60px;
    height: 60px;
  }

  /* Feedback Section */
  #feedback-section {
    background-color: #fffde7;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  #feedback-form .form-group {
    margin-bottom: 15px;
  }

  #feedback-form label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
  }

  #feedback-form input, #feedback-form textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 8px;
    transition: border-color 0.3s ease;
  }

  #feedback-form input:focus, #feedback-form textarea:focus {
    border-color: #00796b;
    outline: none;
  }

  #feedback-form button {
    background-color: #00796b;
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.2s ease;
  }

  #feedback-form button:hover {
    background-color: #004d40;
    transform: translateY(-2px);
  }

  #comments-list {
    list-style: none;
    padding: 0;
    margin-top: 20px;
  }

  #comments-list li {
    background-color: #fff;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 10px;
    border-right: 4px solid #009688;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  }

  /* Footer */
  footer {
    text-align: center;
    padding: 20px;
    background-color: #cfd8dc;
    color: #555;
    font-size: 14px;
    margin-top: 20px;
  }
</style>
</head>
<body>
<header>
  <h1>هواشناسی ایران 🇮🇷</h1>
  <p id="live-time">در حال بارگذاری زمان...</p>
</header>

<main class="container">
  <section class="selectors-section">
    <div class="selector-group">
      <label for="province-select">استان:</label>
      <select id="province-select"></select>
    </div>
    <div class="selector-group">
      <label for="city-select">شهر:</label>
      <select id="city-select"></select>
    </div>
  </section>

  <section id="weather-info">
    <div id="current-weather">
      <h2>وضعیت فعلی</h2>
      <div class="weather-data-card" id="current-data">
        <p>لطفاً یک شهر را انتخاب کنید.</p>
      </div>
    </div>
    <div id="forecast-section">
      <h2>پیش‌بینی ۵ روزه</h2>
      <div id="forecast"></div>
    </div>
  </section>

  <section id="feedback-section">
    <h2>فرم نظرات</h2>
    <form id="feedback-form">
      <div class="form-group">
        <label for="feedback-name">نام:</label>
        <input type="text" id="feedback-name" required>
      </div>
      <div class="form-group">
        <label for="feedback-comment">نظر:</label>
        <textarea id="feedback-comment" rows="4" required></textarea>
      </div>
      <button type="submit">ثبت نظر</button>
    </form>
    <h3>نظرات ثبت‌شده</h3>
    <ul id="comments-list"></ul>
  </section>
</main>

<footer>
  <p>ساخته شده توسط ابوالفضل شاهمیرزایی ❤️</p>
  <p>&copy; ۱۴۰۴</p>
  <p>سایت از API <a href="https://openweathermap.org/" target="_blank">OpenWeatherMap</a> استفاده می‌کند</p>
</footer>

<script>
  // کلید API
  const API_KEY = '0372066e74a2e2ff67fbf207cbc14499';
  
  // لیست کامل استان‌ها و ۲۵ شهر مهم هر استان
  const provinces = {
    "آذربایجان شرقی": [
      "تبریز", "مراغه", "مرند", "اهر", "میانه", "بناب", "شبستر", "جلفا", "سهند", "سراب", "هشترود", "کلیبر", "اسکو", "بستان‌آباد", "آذرشهر", "هریس", "عجب‌شیر", "ورزقان", "ملکان", "قره‌آغاج", "ورزقان", "مبارک‌شهر"
    ],
    "آذربایجان غربی": [
      "ارومیه", "خوی", "مهاباد", "بوکان", "میاندوآب", "سلماس", "پیرانشهر", "نقده", "شاهین‌دژ", "سردشت", "ماکو", "تکاب", "اشنویه", "قره‌ضیاءالدین", "چایپاره", "پلدشت", "شوط", "سیروان", "ربط", "بازرگان", "نوشین‌شهر", "قوشچی"
    ],
    "اردبیل": [
      "اردبیل", "پارس‌آباد", "مشگین‌شهر", "خلخال", "نمین", "نیر", "گرمی", "بیله‌سوار", "کوثر", "سرعین", "گیوی", "اصلاندوز", "هیر", "جعفرآباد", "فیروزآباد", "کلور", "تازه کند", "کوراییم", "اردبیل", "مشگین‌شهر", "پارس‌آباد", "خلخال"
    ],
    "اصفهان": [
      "اصفهان", "کاشان", "خمینی‌شهر", "نجف‌آباد", "فلاورجان", "شاهین‌شهر", "شهرضا", "مبارکه", "زرین‌شهر", "گلپایگان", "خوانسار", "نایین", "درچه", "اردستان", "چادگان", "دولت‌آباد", "لنجان", "میمه", "فولادشهر", "کوهپایه", "آران و بیدگل", "ورزنه"
    ],
    "البرز": [
      "کرج", "فردیس", "کمال‌شهر", "نظرآباد", "محمدشهر", "ماهدشت", "مهرشهر", "هشتگرد", "اشتهارد", "طالقان", "چهارباغ", "گوهردشت", "کوهسار", "کوهک", "نظرآباد", "ساوجبلاغ", "اشتهارد", "کوهسار", "چهارباغ", "طالقان", "ماهدشت", "فردیس"
    ],
    "ایلام": [
      "ایلام", "دهلران", "دره‌شهر", "ایوان", "مهران", "آبدانان", "سرابله", "چرداول", "بدره", "ملکشاهی", "لومار", "موسیان", "چوار", "میمه", "بدره", "سرابله", "ایوان", "دهلران", "آبدانان", "مهران", "ملکشاهی", "دره‌شهر"
    ],
    "بوشهر": [
      "بوشهر", "برازجان", "گناوه", "خورموج", "کنگان", "عسلویه", "جم", "دیلم", "دیر", "شبانکاره", "کاکی", "اهرم", "خارگ", "بندر سیراف", "بندر ریگ", "بندر دیر", "آبپخش", "سعدآباد", "دلوار", "خورموج", "جم", "عسلویه"
    ],
    "تهران": [
      "تهران", "اسلام‌شهر", "شهریار", "قدس", "ملارد", "نسیم‌شهر", "ری", "رباط‌کریم", "ورامین", "قرچک", "پاکدشت", "اندیشه", "پردیس", "دماوند", "بومهن", "شریف‌آباد", "رودهن", "کهریزک", "باغستان", "فردوسیه", "شهر ری", "باقرشهر"
    ],
    "چهارمحال و بختیاری": [
      "شهرکرد", "بروجن", "فارسان", "لردگان", "اردل", "کوهرنگ", "سامان", "بن", "کیار", "فرخ‌شهر", "بلداجی", "سورشجان", "فرخشهر", "چلگرد", "جونقان", "گندمان", "ناغان", "شلمزار", "فرخ‌شهر", "لردگان", "اردل", "کوهرنگ"
    ],
    "خراسان جنوبی": [
      "بیرجند", "قائن", "فردوس", "نهبندان", "طبس", "سرایان", "بشرویه", "خوسف", "اسدیه", "درمیان", "زیرکوه", "آیسک", "خوسف", "طبس", "زیرکوه", "فردوس", "قائن", "بشرویه", "سرایان", "طبس", "نهبندان", "خوسف"
    ],
    "خراسان رضوی": [
      "مشهد", "سبزوار", "نیشابور", "تربت حیدریه", "کاشمر", "قوچان", "بردسکن", "چناران", "فریمان", "خواف", "تایباد", "تربت جام", "گناباد", "درگز", "سرخس", "کلات", "رشتخوار", "مه ولات", "طرقبه", "شاندیز", "بجستان", "خلیل‌آباد"
    ],
    "خراسان شمالی": [
      "بجنورد", "شیروان", "اسفراین", "جاجرم", "مانه و سملقان", "فاروج", "گرمه", "راز و جرگلان", "قاضی", "درق", "ایور", "آوا", "لوجلی", "غلامان", "زیارت", "آشخانه", "اسفراین", "جاجرم", "راز", "سملقان", "مانه", "شیروان"
    ],
    "خوزستان": [
      "اهواز", "دزفول", "آبادان", "خرمشهر", "اندیمشک", "مسجدسلیمان", "ایذه", "بهبهان", "شوشتر", "ماهشهر", "سوسنگرد", "شوش", "باغ‌ملک", "رامشیر", "شادگان", "امیدیه", "هندیجان", "لالی", "رامهرمز", "دشت آزادگان", "شادگان", "شوش"
    ],
    "زنجان": [
      "زنجان", "ابهر", "خرمدره", "قیدار", "سلطانیه", "ماهنشان", "سجاس", "زرین‌آباد", "دندی", "ارمغانخانه", "نوربهار", "سجین", "هیدج", "صایین‌قلعه", "آب‌بر", "سهرورد", "قیدار", "خرمدره", "ابهر", "زنجان", "سلطانیه", "ماهنشان"
    ],
    "سمنان": [
      "سمنان", "شاهرود", "دامغان", "گرمسار", "مهدی‌شهر", "ایوانکی", "بسطام", "میامی", "سرخه", "دیباج", "بیارجمند", "شهمیرزاد", "کالپوش", "مجین", "حسین‌آباد", "فارسان", "شاهرود", "دامغان", "گرمسار", "مهدی‌شهر", "ایوانکی", "شهمیرزاد"
    ],
    "سیستان و بلوچستان": [
      "زاهدان", "زابل", "ایرانشهر", "چابهار", "خاش", "سراوان", "کنارک", "نیک‌شهر", "سرباز", "راسک", "فنوج", "مهرستان", "قصرقند", "سیب و سوران", "دشتیاری", "دلگان", "زابل", "ایرانشهر", "چابهار", "خاش", "سراوان", "کنارک"
    ],
    "فارس": [
      "شیراز", "مرودشت", "کازرون", "جهرم", "فسا", "لار", "فیروزآباد", "اقلید", "داراب", "لامرد", "نورآباد", "ممسنی", "نی‌ریز", "آباده", "صفاشهر", "استهبان", "گراش", "خنج", "قیر و کارزین", "پاسارگاد", "بوانات", "سروستان"
    ],
    "قزوین": [
      "قزوین", "تاکستان", "الوند", "اقبالیه", "آبیک", "بیدستان", "بوئین‌زهرا", "شال", "مهرگان", "اسفرورین", "کوهین", "آوج", "ضیاءآباد", "خاکعلی", "شال", "تاکستان", "آبیک", "الوند", "اقبالیه", "مهرگان", "بوئین‌زهرا", "شال"
    ],
    "قم": [
      "قم", "جعفریه", "کهک", "سلفچگان", "دستجرد", "قنوات", "کوشا", "قمصر", "جعفریه", "دستجرد", "قنوات", "کهک", "سلفچگان", "جعفریه", "کهک", "سلفچگان", "قنوات", "دستجرد", "قم", "قمصر", "جعفریه", "کهک"
    ],
    "کردستان": [
      "سنندج", "سقز", "مریوان", "بانه", "قروه", "کامیاران", "دیواندره", "بیجار", "سروآباد", "دهگلان", "بشرویه", "موچش", "سریش‌آباد", "دلبران", "قروه", "کامیاران", "دیواندره", "سقز", "مریوان", "بانه", "بیجار", "سروآباد"
    ],
    "کرمان": [
      "کرمان", "سیرجان", "رفسنجان", "جیرفت", "بم", "کهنوج", "بافت", "بردسیر", "زرند", "عنبرآباد", "شهربابک", "منوجان", "قلعه‌گنج", "راور", "کوهبنان", "ریگان", "فهرج", "انار", "رودبار", "کهنوج", "زرند", "بردسیر"
    ],
    "کرمانشاه": [
      "کرمانشاه", "اسلام‌آباد غرب", "جوانرود", "کنگاور", "صحنه", "سنقر", "پاوه", "هرسین", "قصر شیرین", "سرپل ذهاب", "گیلانغرب", "روانسر", "ثلاث باباجانی", "کوزران", "ماهیدشت", "روانسر", "جوانرود", "کنگاور", "اسلام‌آباد غرب", "صحنه", "سنقر", "پاوه"
    ],
    "کهگیلویه و بویراحمد": [
      "یاسوج", "گچساران", "دوگنبدان", "دهدشت", "لیکک", "باشت", "سی‌سخت", "چرام", "لنده", "سوق", "پاتاوه", "مادوان", "لیکک", "دهدشت", "گچساران", "سی‌سخت", "لیکک", "باشت", "چرام", "لنده", "سوق", "پاتاوه"
    ],
    "گلستان": [
      "گرگان", "گنبد کاووس", "بندر ترکمن", "علی‌آباد کتول", "آق‌قلا", "کردکوی", "مینودشت", "گالیکش", "کلاله", "رامیان", "آزادشهر", "گمیشان", "سیمین‌شهر", "نوکنده", "خان ببین", "اینچه‌برون", "آق‌قلا", "علی‌آباد کتول", "کردکوی", "گنبد کاووس", "بندر ترکمن", "مینودشت"
    ],
    "گیلان": [
      "رشت", "انزلی", "لاهیجان", "لنگرود", "تالش", "رودبار", "رودسر", "فومن", "صومعه‌سرا", "آستانه اشرفیه", "آستارا", "ماسال", "سیاهکل", "املش", "رضوان‌شهر", "کوچصفهان", "کیاشهر", "شفت", "چمخاله", "رحیم‌آباد", "لوشان", "کلاچای"
    ],
    "لرستان": [
      "خرم‌آباد", "بروجرد", "دورود", "کوهدشت", "الیگودرز", "نورآباد", "پلدختر", "ازنا", "الشتر", "چگنی", "معمولان", "سراب دوره", "رومشگان", "کونانی", "چغابل", "دورود", "بروجرد", "الیگودرز", "کوهدشت", "پلدختر", "ازنا", "الشتر"
    ],
    "مازندران": [
      "ساری", "بابل", "آمل", "قائم‌شهر", "بابلسر", "بهشهر", "تنکابن", "نوشهر", "چالوس", "فریدون‌کنار", "رامسر", "نور", "محمودآباد", "نکا", "جویبار", "عباس‌آباد", "سوادکوه", "کلاردشت", "رامسر", "بابل", "آمل", "قائم‌شهر"
    ],
    "مرکزی": [
      "اراک", "ساوه", "خمین", "محلات", "دلیجان", "زرندیه", "شازند", "آشتیان", "فراهان", "تفرش", "سربند", "کمیجان", "مهاجران", "مأمونیه", "نوبران", "تفرش", "خمین", "ساوه", "محلات", "دلیجان", "زرندیه", "شازند"
    ],
    "هرمزگان": [
      "بندرعباس", "میناب", "قشم", "کیش", "بندر لنگه", "رودان", "جاسک", "بستک", "حاجی‌آباد", "پارسیان", "سیریک", "بشاگرد", "کوهستک", "تنگه", "چارک", "سندرک", "میناب", "قشم", "کیش", "بندر لنگه", "رودان", "حاجی‌آباد"
    ],
    "همدان": [
      "همدان", "ملایر", "نهاوند", "تویسرکان", "اسدآباد", "کبودراهنگ", "بهار", "رزن", "فامنین", "قروه درجزین", "دمق", "جوکار", "ازندریان", "سامن", "جورقان", "قهاوند", "رزن", "ملایر", "نهاوند", "تویسرکان", "اسدآباد", "کبودراهنگ"
    ],
    "یزد": [
      "یزد", "میبد", "اردکان", "تفت", "بافق", "ابرکوه", "مهریز", "اشکذر", "هرات", "شاهدیه", "حمیدیا", "زارچ", "نیر", "مروست", "عقدا", "بهاباد", "احمدآباد", "سایبان", "خضرآباد", "ندوشن", "نیر", "بهاباد"
    ]
  };

  // المنت‌ها
  const provinceSelect = document.getElementById('province-select');
  const citySelect = document.getElementById('city-select');
  const liveTimeElement = document.getElementById('live-time');
  const currentData = document.getElementById('current-data');
  const forecastDiv = document.getElementById('forecast');
  const feedbackForm = document.getElementById('feedback-form');
  const commentsList = document.getElementById('comments-list');

  // ساعت زنده
  function updateLiveTime() {
    const now = new Date();
    liveTimeElement.textContent = now.toLocaleString('fa-IR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' });
  }
  setInterval(updateLiveTime, 1000);

  // پر کردن لیست استان‌ها
  function populateProvinces() {
    for (const province in provinces) {
      const option = document.createElement('option');
      option.value = province;
      option.textContent = province;
      provinceSelect.appendChild(option);
    }
  }

  // پر کردن شهرها بر اساس استان انتخاب شده
  function populateCities() {
    citySelect.innerHTML = '<option value="">شهر را انتخاب کنید</option>';
    const selectedProvince = provinceSelect.value;
    if (selectedProvince) {
      provinces[selectedProvince].forEach(city => {
        const option = document.createElement('option');
        option.value = city;
        option.textContent = city;
        citySelect.appendChild(option);
      });
    }
  }

  // تغییر استان
  provinceSelect.addEventListener('change', () => {
    populateCities();
    currentData.innerHTML = '<p>لطفاً یک شهر را انتخاب کنید.</p>';
    forecastDiv.innerHTML = '';
  });

  // تغییر شهر
  citySelect.addEventListener('change', () => {
    const city = citySelect.value;
    if (city) {
      fetchWeather(city);
    }
  });

  // دریافت آب و هوا از OpenWeatherMap
  function fetchWeather(city) {
    const currentUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city},IR&appid=${API_KEY}&units=metric&lang=fa`;
    const forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${city},IR&appid=${API_KEY}&units=metric&lang=fa`;

    fetch(currentUrl)
      .then(res => res.json())
      .then(data => {
        if (data.cod === 200) {
          const iconCode = data.weather[0].icon;
          const iconUrl = `http://openweathermap.org/img/wn/${iconCode}@2x.png`;
          currentData.innerHTML = `
            <h3>${city}</h3>
            <img src="${iconUrl}" alt="${data.weather[0].description}">
            <p>دما: ${Math.round(data.main.temp)}°C</p>
            <p>وضعیت: ${data.weather[0].description}</p>
            <p>رطوبت: ${data.main.humidity}%</p>
            <p>سرعت باد: ${data.wind.speed} متر بر ثانیه</p>
          `;
        } else {
          currentData.innerHTML = '<p class="error">خطا در دریافت اطلاعات.</p>';
        }
      })
      .catch(() => {
        currentData.innerHTML = '<p class="error">خطا در اتصال به سرور.</p>';
      });

    fetch(forecastUrl)
      .then(res => res.json())
      .then(data => {
        if (data.cod === "200") {
          forecastDiv.innerHTML = '';
          for (let i = 0; i < data.list.length; i += 8) {
            const item = data.list[i];
            const iconCode = item.weather[0].icon;
            const iconUrl = `http://openweathermap.org/img/wn/${iconCode}@2x.png`;
            const card = document.createElement('div');
            card.className = 'forecast-card';
            card.innerHTML = `
              <p>${new Date(item.dt * 1000).toLocaleDateString('fa-IR', { weekday: 'long' })}</p>
              <img src="${iconUrl}" alt="${item.weather[0].description}">
              <p>دما: ${Math.round(item.main.temp)}°C</p>
              <p>${item.weather[0].description}</p>
            `;
            forecastDiv.appendChild(card);
          }
        } else {
          forecastDiv.innerHTML = '<p class="error">خطا در دریافت پیش‌بینی.</p>';
        }
      })
      .catch(() => {
        forecastDiv.innerHTML = '<p class="error">خطا در اتصال به سرور.</p>';
      });
  }

  // فرم نظرات
  feedbackForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const name = document.getElementById('feedback-name').value;
    const comment = document.getElementById('feedback-comment').value;
    if (name && comment) {
      const commentItem = document.createElement('li');
      commentItem.innerHTML = `<strong>${name}:</strong> ${comment}`;
      commentsList.appendChild(commentItem);

      const storedComments = JSON.parse(localStorage.getItem('weather-comments')) || [];
      storedComments.push({ name, comment });
      localStorage.setItem('weather-comments', JSON.stringify(storedComments));

      feedbackForm.reset();
    }
  });

  // بارگذاری نظرات ذخیره شده
  function loadComments() {
    const storedComments = JSON.parse(localStorage.getItem('weather-comments')) || [];
    storedComments.forEach(c => {
      const commentItem = document.createElement('li');
      commentItem.innerHTML = `<strong>${c.name}:</strong> ${c.comment}`;
      commentsList.appendChild(commentItem);
    });
  }

  // اجرای اولیه
  populateProvinces();
  populateCities();
  loadComments();
  updateLiveTime();
</script>
</body>
</html>
